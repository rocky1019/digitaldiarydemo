<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Digital Diary (Local Demo)</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --lavender: #BA9EFF;
      --mint: #C6FFF6;
      --pink: #F7A8F8;
      --bg: #f5f6fa;
      --text: #222;
      --muted: #888;
      --card: #fff;
      --radius: 16px;
      font-family: 'Poppins', sans-serif;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{background:var(--bg);color:var(--text);display:flex;flex-direction:column;height:100vh}
    .main-content{flex:1;overflow-y:auto;padding-bottom:80px}
    .page{display:none;padding:1rem}
    .page.active{display:block}
    .header{padding:1rem;text-align:center;font-weight:600;font-size:1.25rem;background:#fff;position:sticky;top:0;z-index:10;border-bottom:1px solid #ddd}
    /* Post Card */
    .post-card{background:var(--card);border-radius:var(--radius);margin-bottom:1rem;box-shadow:0 2px 6px rgba(0,0,0,0.1);transition:transform .14s}
    .post-card:hover{transform:scale(1.015);box-shadow:0 8px 18px rgba(186,158,255,0.09)}
    .post-header{display:flex;align-items:center;padding:.75rem}
    .post-avatar{width:40px;height:40px;border-radius:50%;background:#ccc;background-size:cover;background-position:center}
    .post-details{margin-left:.75rem;flex:1}
    .post-date{font-size:.8rem;color:var(--muted)}
    .post-photo{width:100%;display:block;border-bottom-left-radius:var(--radius);border-bottom-right-radius:var(--radius)}
    .post-body{padding:1rem}
    .post-caption{font-size:1rem}
    .post-meta{display:flex;justify-content:space-between;margin-top:.5rem;color:var(--muted);font-size:.9rem}
    /* Profile */
    .profile-header{text-align:center;padding:1rem}
    .profile-avatar{width:90px;height:90px;border-radius:50%;background:#ddd;margin:0 auto;background-size:cover;background-position:center;cursor:pointer}
    .profile-name{margin-top:.5rem;font-size:1.2rem;font-weight:600;cursor:pointer}
    .stats{display:flex;justify-content:center;gap:2rem;margin-top:1rem}
    .gallery{display:grid;grid-template-columns:repeat(3,1fr);gap:3px;margin-top:1rem}
    .gallery img{width:100%;height:100px;object-fit:cover;border-radius:6px}
    /* Add Entry */
    textarea{width:100%;min-height:100px;padding:.75rem;border:1px solid #ccc;border-radius:var(--radius);margin-bottom:.75rem}
    .mood-selector{display:flex;gap:.5rem;margin-bottom:.75rem}
    .mood-icon{font-size:1.5rem;cursor:pointer;transition:transform .12s,color .12s}
    .mood-icon.selected{color:var(--lavender);background:#f7efff;border-radius:9px;transform:scale(1.23);box-shadow:0 1px 6px rgba(186,158,255,.07);}
    .privacy-toggle{margin-bottom:.75rem}
    .add-photo-btn{background:#f0f0f0;padding:.75rem;border-radius:var(--radius);text-align:center;cursor:pointer;margin-bottom:.75rem}
    .btn{display:block;width:100%;padding:.75rem;border:none;border-radius:var(--radius);background:linear-gradient(90deg,var(--lavender),var(--pink));color:#fff;font-weight:600;cursor:pointer;transition:background .13s}
    .btn:disabled{opacity:.6;cursor:not-allowed;background:var(--muted);}
    /* Settings */
    .settings-item{background:#fff;padding:1rem;border-radius:var(--radius);margin-bottom:.5rem;display:flex;justify-content:space-between}
    /* Bottom Nav */
    nav{position:fixed;bottom:0;left:0;right:0;background:#fff;border-top:1px solid #ddd;display:flex;justify-content:space-around;padding:.5rem 0;z-index:50}
    .nav-btn{border:none;background:none;display:flex;flex-direction:column;align-items:center;font-size:.8rem;color:var(--muted);cursor:pointer;transition:color .12s}
    .nav-btn.active{color:var(--lavender)}
    .add-btn-wrapper{background:linear-gradient(45deg,var(--mint),var(--lavender));border-radius:50%;width:55px;height:55px;display:flex;align-items:center;justify-content:center;position:relative;top:-20px;color:#fff;font-size:2rem}
    /* Onboarding Modal */
    .modal{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.5);display:flex;align-items:center;justify-content:center;z-index:1000}
    .modal-content{background:#fff;padding:1.5rem;border-radius:var(--radius);width:90%;max-width:400px;text-align:center}
    .modal h2{margin-bottom:1rem}
    .modal input[type=text]{width:100%;padding:.75rem;border:1px solid #ccc;border-radius:var(--radius);margin-bottom:1rem}
    .modal .avatar-preview{width:80px;height:80px;border-radius:50%;background:#ddd;margin:0 auto 1rem;background-size:cover;background-position:center}
    /* Snackbar */
    #snackbar{display:none;position:fixed;bottom:70px;left:50%;transform:translateX(-50%);
      background:var(--lavender);color:#fff;padding:.8em 2em;border-radius:30px;font-weight:500;
      box-shadow:0 6px 28px rgba(186,158,255,0.16);z-index:2000;opacity:0;transition:opacity .4s;}
  </style>
</head>
<body>

<!-- Snackbar -->
<div id="snackbar"></div>

<!-- Onboarding Modal -->
<div id="onboarding" class="modal" style="display:none;">
  <div class="modal-content">
    <h2>Welcome üëã</h2>
    <div id="avatarPreview" class="avatar-preview"></div>
    <input type="file" id="onboardAvatar" accept="image/*">
    <input type="text" id="onboardName" placeholder="Enter your name">
    <button class="btn" id="saveOnboard">Save</button>
  </div>
</div>

<div class="main-content">
  <!-- Home -->
  <div id="home" class="page active">
    <header class="header">Digital Diary</header>
    <div id="feed"></div>
  </div>

  <!-- Profile -->
  <div id="profile" class="page">
    <header class="header">Profile</header>
    <div class="profile-header">
      <div id="profileAvatar" class="profile-avatar"></div>
      <div id="profileName" class="profile-name">Tap to set name</div>
      <div class="stats">
        <div><span id="statTotal">0</span><br/>Entries</div>
        <div><span id="statPublic">0</span><br/>Public</div>
        <div><span id="statPrivate">0</span><br/>Private</div>
      </div>
    </div>
    <div id="gallery" class="gallery"></div>
  </div>

  <!-- Add Entry -->
  <div id="add" class="page">
    <header class="header">New Entry</header>
    <textarea id="entryText" placeholder="What's on your mind today..."></textarea>
    <div class="mood-selector">
      <span class="mood-icon">üòä</span>
      <span class="mood-icon">üòî</span>
      <span class="mood-icon">üò¥</span>
      <span class="mood-icon">ü§î</span>
      <span class="mood-icon">‚ú®</span>
    </div>
    <div class="add-photo-btn" onclick="document.getElementById('photoInput').click()">üñºÔ∏è Add Photo</div>
    <input type="file" id="photoInput" accept="image/*" style="display:none">
    <div class="privacy-toggle">
      <label><input type="checkbox" id="privacyToggle" checked> <span id="privacyLabel">Private üîí</span></label>
    </div>
    <button class="btn" id="postBtn">Post</button>
  </div>

  <!-- Settings -->
  <div id="settings" class="page">
    <header class="header">Settings</header>
    <div class="settings-item"><span>Clear All Data</span><button onclick="clearData()">üóëÔ∏è</button></div>
  </div>
</div>

<!-- Nav -->
<nav>
  <button class="nav-btn active" data-page="home">üè† Home</button>
  <button class="nav-btn" data-page="profile">üë§ Profile</button>
  <button class="nav-btn" data-page="add"><div class="add-btn-wrapper">+</div></button>
  <button class="nav-btn" data-page="settings">‚öôÔ∏è Settings</button>
</nav>

<script>
  // ===== Data =====
  let posts = JSON.parse(localStorage.getItem('posts')) || [];
  let profile = JSON.parse(localStorage.getItem('profile')) || {name:'', avatar:''};

  // ===== Onboarding =====
  const onboarding=document.getElementById('onboarding');
  const onboardName=document.getElementById('onboardName');
  const onboardAvatar=document.getElementById('onboardAvatar');
  const avatarPreview=document.getElementById('avatarPreview');
  if(!profile.name){ onboarding.style.display='flex'; }

  onboardAvatar.addEventListener('change',e=>{
    const file=e.target.files[0];
    const reader=new FileReader();
    reader.onload=()=>{ avatarPreview.style.backgroundImage=`url(${reader.result})`; profile.avatar=reader.result; };
    if(file) reader.readAsDataURL(file);
  });

  document.getElementById('saveOnboard').onclick=()=>{
    if(onboardName.value.trim()===''){showSnackbar("Enter a name!");return;}
    profile.name=onboardName.value.trim();
    localStorage.setItem('profile',JSON.stringify(profile));
    onboarding.style.display='none';
    renderProfile();
    showSnackbar("Welcome, " + profile.name + "!");
  };

  // ===== Elements =====
  const pages=document.querySelectorAll('.page');
  const navBtns=document.querySelectorAll('nav button');
  const feed=document.getElementById('feed');
  const gallery=document.getElementById('gallery');
  const profileName=document.getElementById('profileName');
  const profileAvatar=document.getElementById('profileAvatar');
  const statTotal=document.getElementById('statTotal');
  const statPublic=document.getElementById('statPublic');
  const statPrivate=document.getElementById('statPrivate');
  const postBtn = document.getElementById('postBtn');

  // ===== Navigation =====
  function scrollToTop(){ document.querySelector('.main-content').scrollTop = 0; }
  navBtns.forEach(btn=>{
    btn.addEventListener('click',()=>{
      const page=btn.dataset.page;
      pages.forEach(p=>p.classList.remove('active'));
      document.getElementById(page).classList.add('active');
      navBtns.forEach(b=>b.classList.remove('active'));
      btn.classList.add('active');
      scrollToTop();
      if(page==='home') renderFeed();
      if(page==='profile') renderProfile();
    });
  });

  // ===== Snackbar Feedback =====
  function showSnackbar(msg){
    const sn=document.getElementById('snackbar');
    sn.textContent = msg;
    sn.style.display="block";
    sn.style.opacity=1;
    setTimeout(()=>{sn.style.opacity=0;},2000);
    setTimeout(()=>{sn.style.display="none";},2300);
  }

  // ===== Profile =====
  function renderProfile(){
    profileName.textContent=profile.name||'Tap to set name';
    // Avatar placeholder
    profileAvatar.style.backgroundImage = profile.avatar
      ? `url(${profile.avatar})`
      : `url('https://ui-avatars.com/api/?name=${encodeURIComponent(profile.name||'User')}&background=BA9EFF&color=fff&rounded=true')`;
    gallery.innerHTML='';
    statTotal.textContent=posts.length;
    statPublic.textContent=posts.filter(p=>!p.private).length;
    statPrivate.textContent=posts.filter(p=>p.private).length;
    const images = posts.filter(p => p.photo);
    if(images.length === 0){
      gallery.innerHTML = '<div style="color:var(--muted);text-align:center;padding:1em 0">No photos uploaded yet</div>';
    } else {
      images.forEach(p=>{
        const img=document.createElement('img');
        img.src=p.photo;img.className='gallery-item';
        gallery.appendChild(img);
      });
    }
  }

  profileName.onclick=()=>{
    const name=prompt("Enter your name:",profile.name);
    if(name){
      profile.name=name;
      localStorage.setItem('profile',JSON.stringify(profile));
      renderProfile();
      showSnackbar("Name updated!");
    }
  };
  profileAvatar.onclick=()=>{
    const input=document.createElement('input');
    input.type='file';input.accept='image/*';
    input.onchange=e=>{
      const file=e.target.files[0];
      const reader=new FileReader();
      reader.onload=()=>{profile.avatar=reader.result; localStorage.setItem('profile',JSON.stringify(profile)); renderProfile();showSnackbar("Avatar updated!");};
      if(file) reader.readAsDataURL(file);
    };
    input.click();
  };

  // ===== Add Entry =====
  let selectedMood='';
  document.querySelectorAll('.mood-icon').forEach(icon=>{
    icon.addEventListener('click',()=>{
      document.querySelectorAll('.mood-icon').forEach(i=>i.classList.remove('selected'));
      icon.classList.add('selected');
      selectedMood=icon.textContent;
    });
  });

  document.getElementById('privacyToggle').addEventListener('change',e=>{
    document.getElementById('privacyLabel').textContent=e.target.checked?'Private üîí':'Public üåç';
  });

  let photoData='';
  document.getElementById('photoInput').addEventListener('change',e=>{
    const file=e.target.files[0];
    if(file){
      const reader=new FileReader();
      reader.onload=()=>{photoData=reader.result;};
      reader.readAsDataURL(file);
    }
  });

  postBtn.addEventListener('click', () => {
    const text=document.getElementById('entryText').value.trim();
    if(!text && !photoData){showSnackbar("Write something or add a photo!");return;}
    postBtn.disabled = true;
    postBtn.textContent = "Posting...";
    const isPrivate=document.getElementById('privacyToggle').checked;
    const entry={id:Date.now(),text,photo:photoData,mood:selectedMood,private:isPrivate,date:new Date().toLocaleString()};
    posts.unshift(entry);
    localStorage.setItem('posts',JSON.stringify(posts));
    setTimeout(() => {
      postBtn.disabled = false;
      postBtn.textContent = "Post";
      document.getElementById('entryText').value='';
      photoData='';selectedMood='';
      document.querySelectorAll('.mood-icon').forEach(i=>i.classList.remove('selected'));
      renderFeed();renderProfile();
      showSnackbar("Entry posted!");
    }, 800);
  });

  // ===== Feed =====
  function renderFeed(){
    feed.innerHTML = '';
    if(posts.length === 0) {
      feed.innerHTML = `
        <div style="
          display:flex;flex-direction:column;align-items:center;
          gap:.7rem;padding:2rem 0;color:var(--muted)">
          <div style="font-size:2.5rem">üìù</div>
          <div style="font-size:1.1rem;font-weight:500">No entries yet</div>
          <div style="font-size:.98rem;">Start capturing your memories!</div>
        </div>
      `;
      return;
    }
    posts.forEach(p=>{
      // fallback avatar if missing
      const avatarUrl = profile.avatar
        ? profile.avatar
        : `https://ui-avatars.com/api/?name=${encodeURIComponent(profile.name||'User')}&background=BA9EFF&color=fff&rounded=true`;
      const card=document.createElement('div');
      card.className='post-card';
      card.innerHTML=`
        <div class="post-header">
          <div class="post-avatar" style="background-image:url('${avatarUrl}')"></div>
          <div class="post-details"><div class="post-date">${p.date}</div></div>
        </div>
        ${p.photo?`<img class="post-photo" src="${p.photo}">`:''}
        <div class="post-body">
          <div class="post-caption">${p.text || ''}</div>
          <div class="post-meta"><span>${p.mood||''}</span><span>${p.private?'üîí Private':'üåç Public'}</span></div>
        </div>`;
      feed.appendChild(card);
    });
  }

  // ===== Settings =====
  function clearData(){
    if(confirm("Clear all saved data?")){
      localStorage.clear();
      posts=[];profile={name:'',avatar:''};
      renderFeed();renderProfile();
      onboarding.style.display='flex';
      showSnackbar("All data cleared.");
    }
  }

  // Init
  renderFeed();renderProfile();
</script>

</body>
</html>


